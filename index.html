<!doctype html>
<html lang="en">
<head>
    <!--
    Legal info on images:
    * Valentine background
        Paid
        iStockphoto.com order number 2062552735
    * "The Child" with heart
        Free
        Attribution: https://stlmotherhood.com/baby-yoda-valentines-for-your-kids-classroom-party/        
    * The others
        Free for non-commercial use
        Attribution: <a href="https://www.clipart.email/">clipart.email</a>
    -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />

    <title>Valentine's Boxes</title>

    <link
      type="text/css" rel="stylesheet"
      href="https://unpkg.com/bootstrap/dist/css/bootstrap.min.css"
    />
    <link
      type="text/css" rel="stylesheet"
      href="https://unpkg.com/bootstrap-vue@latest/dist/bootstrap-vue.css"
    />
    <link href='http://fonts.googleapis.com/css?family=Great+Vibes' rel='stylesheet' type='text/css'>
    <link 
        rel="stylesheet" 
        href="https://use.fontawesome.com/releases/v5.2.0/css/all.css" 
        integrity="sha384-hWVjflwFxL6sNzntih27bfxkr27PmbbK/iSvJ+a4+0owXq79v+lsFkW54bOGbiDQ" 
        crossorigin="anonymous"s
    />
    <link type="text/css" rel="stylesheet" href="./css/styles.css" />
    <script src="https://unpkg.com/vue@latest/dist/vue.js"></script>
    <script src="https://unpkg.com/bootstrap-vue@latest/dist/bootstrap-vue.js"></script>
</head>
<body>
    <div id="app">
        <b-container>
            <b-row id="header" class="pt-2 pb-2">
                <b-col>
                    <b-img src="./img/box-of-valentine-hearts_458-370.png" 
                           alt="Image: square box cornucopia of hearts" id="header_image">
                    </b-img>
                    <span id="site_title">Valentine's Day Subscription In A Box</span>
                </b-col>
            </b-row>
            <b-row class="d-xs-block d-lg-none">
                <b-col>
                    {{page.overview.text}}
                </b-col>
            </b-row>
            <b-row class="mt-2 pt-3 pb-3" id="overview_row">
                <b-col id="overview_col" class="d-none d-lg-block col-lg-9">
                    <overview_pane :overview="page.overview" :greeting="page.greeting"></overview_pane>
                </b-col>

                <b-col class="col=md-12 col-lg-3">
                    <b-form @submit="onCheckoutSubmit" class="clearfix">
                        <b-form-group id="subscription" class="cart_controls">
                            <b-form-radio v-model="cart.purchase_type" name="purchase_type_radios" 
                                            value="subscription" selected 
                                            class="cart_controls cart_text mr-3">
                                Subscription
                            </b-form-radio>
                            <b-form-radio v-model="cart.purchase_type" name="purchase_type_radios" 
                                            value="onetime" class="cart_controls cart_text">
                                One time purchase
                            </b-form-radio>
                        </b-form-group>
                        <div id="cart_container" class="cart_controls">
                           <b-button class="cart_controls float-right no-gutters ml-3" 
                                     type="submit" variant="warning">Checkout
                            </b-button>
                           <span class="cart_controls float-right mt-1 mr-2">
                               <i id="shopping_cart" class="text-primary fas fa-shopping-cart"></i>
                               {{ cart_item_count() }} 
                            </span>
                        </div>
                    </b-form>
                </b-col>
            </b-row>
            <b-row>
                <b-col id="choose_msg_col" class="h5 md-12 mt-2 mb-3 text-center font-weight-bold">
                    <div id="choose_msg" class="pl-5 pr-5 pt-2 pb-2 mx-auto">
                        <span>3 sets of 25 themed cards to choose from!</span>
                    </div>
                </b-col>
            </b-row>
            <b-row class="align-items-stretch">
                <product_panel
                    v-for="(product, idx) in page.products"
                    :product="product"
                    :collection_image="theme_collection_image(product.selection_values.theme)"
                    :update_theme_stickers_image="update_theme_stickers_image"
                    :add_to_cart="add_to_cart"
                    :key="product.id"
                >
                </product_panel>

            </b-row>
            <footer class="mt-3">
                <b-row class="justify-content-center">
                    <b-col>
                        <p id="copyright" class="d-flex justify-content-center">
                            Copyright 2020, Unobtainium Box Crafts Inc., All Rights Reserved.
                        </p>
                    </b-col>
                </b-row>
            </footer>             
        </b-container>   
    </div>

    <script>
        Vue.component('overview_pane', {
            props: ['overview', 'greeting'],
            template: `<b-row>
                            <b-col class md="4">
                                <b-img :src="overview.image" :alt="overview.image_alt"
                                        id="overview_image" class="img-fluid mb-2">
                                </b-img>
                            </b-col>
                            <b-col class md="7">
                                <b-row class="d-none d-lg-block">
                                    <div class="d-flex justify-content-center">
                                        <b-card-img class="d-inline" id="greeting_image" 
                                                    :src="greeting.image" :alt="greeting.image_alt"
                                        > 
                                        </b-card-img>
                                        <b-card-text class="ml-2 d-inline">{{greeting.text}}</b-card-text>
                                    </div>
                                </b-row>
                                <b-row>
                                    <p class="mt-3">{{overview.text}}</p>
                                </b-row>
                            </b-col>    
                            <b-col class md="1">
                            </b-col>
                      </b-row>`
        });

        // Handle both single and multiple values for an item in the product collection.
        // Single values to be rendered as text; multiple as a select.
        // Expecting any multiple options to be given as a list of strings.
        Vue.component('product_item', {
            props: ['item', 'box'],
            template: `<b-row class="mt-2 no-gutters">
                            <!-- <b-img class="item_image d-md-none d-lg-block mr-2" :src="item.image" alt="Image: item in a collection"></b-img> -->

                            <b-img class="item_image mr-2" :src="item.image" alt="Image: item in a collection"></b-img>
                            <br class="d-none d-md-block d-lg-none" />

                            <template v-if="typeof item.description === 'string'" 
                            class="d-inline item">
                                <span class="item_desc">{{item.description}}</span>
                            </template>
                            <template v-else-if="item.description.length === 1" class="d-inline">
                                <span class="item_desc">{{item.description[0]}}</span>
                            </template>
                            <template v-else>
                                <b-form-select class="d-inline item_option_select" v-model="box">
                                    <b-form-select-option 
                                        v-for="(desc, idx) in item.description" 
                                        :value="desc"
                                        :key="idx"
                                    >
                                        {{desc}}
                                    </b-form-select-option>
                                </b-form-select>
                            </template>
                        </b-row>`
        });

        Vue.component('product_panel', {
            props: ['product', 'collection_image', 'update_theme_stickers_image', 'add_to_cart'],
            template:
                   `<b-col class md="4" >
                        <b-card class="h-100 product_card"">
                            <b-card-text class="h5 font-weight-bold product_title">
                                {{product.title}} \${{product.price}}
                            </b-card-text>
                            <b-card-img class="collection_image" :src="collection_image" alt="Image: collection"></b-card-img>
                            
                            <b-row class="mt-2 quantity_row justify-content-between no-gutters">
                                <template v-if="product.in_stock">
                                    <b-card-text class="text-success mt-2 mr-3">In Stock</b-card-text>
                                </template>
                                <template v-else>
                                    <b-card-text class="text-danger mt-2 mr-3">Out</b-card-text>
                                </template>
                                <b-form-select class="product_qty" v-model="product.selection_values.quantity">
                                    <b-form-select-option value="1">Qty 1</b-form-select-option>
                                    <b-form-select-option value="2">Qty 2</b-form-select-option>
                                    <b-form-select-option value="3">Qty 3</b-form-select-option>
                                    <b-form-select-option value="4">Qty 4</b-form-select-option>
                                    <b-form-select-option value="5">Qty 5</b-form-select-option>
                                </b-form-select>
                            </b-row>
                            <template v-if="product.in_stock">
                                <b-button class="add_to_cart_btn mb-2" variant="warning" @click="add_to_cart(product)">
                                    Add to Cart
                                </b-button>
                            </template>
                            <template v-else>
                                <b-button class="disabled add_to_cart_btn mb-2" variant="warning">Add to Cart</b-button>
                            </template>

                            <b-card-text class="choose_theme">Choose a theme:</b-card-text>
                            <b-row class="theme_row no-gutters">
                                <b-form-select class="h-100" 
                                    v-model="product.selection_values.theme"
                                    :options="product.card_themes"
                                    v-on:change="update_theme_stickers_image($event, product)"
                                >
                                </b-form-select>
                            </b-row>

                            <product_item
                                v-for="item in product.set_items"
                                :item="item"
                                :box="product.selection_values.box"
                                :key="item.id"
                            >
                            </product_item>
                        </b-card>
                    </b-col>`
        });

        window.app = new Vue({
            el: '#app',
            computed: {
            },
            methods: {
                onCheckoutSubmit() {
                    return true;
                },
                theme_collection_image(theme_name) {
                    // Return the theme collection image
                    // Arg: product.selection_values.theme
                    return this.page.theme_images[theme_name].collection; 
                },
                update_theme_stickers_image(new_selection, product) {
                    // Update the stickers image for the newly-selected theme for the current product.
                    // (The theme collection image is updated via v-model.)
                    let theme = product.selection_values.theme;
                    let stickers_image = this.page.theme_images[theme].stickers;
                    for (let item of product.set_items) {
                        if (item.item_type === 'stickers') {
                            item.image = stickers_image;
                            break;
                        }
                    }
                },
                add_to_cart(product) {
                    let kit = JSON.parse(JSON.stringify(product.selection_values));
                    this.cart.items.push(kit);
                },
                cart_item_count() {
                    return this.cart.items.reduce((acc, cur) => acc + parseInt(cur.quantity, 10), 0);
                }
            },        
            data: {
                selected: true,
                page:
                {
                    overview: {
                        image: "./img/valentine-clipart-for-kids_640-295.png",
                        image_alt: "Image: sample kit collection",
                        text: `Handmade Valentine's cards show how much you care and with our kits they are easy and fun! 
                               We provide everything you need to turn 25 starter cards and a stylable box into unique 
                               and attractive gifts that your classmates will enjoy. Markers and paints are completely
                               washable.`
                    },
                    greeting: {
                        image: "./img/transparent-background-yoda-clipart_230-192.png",
                        image_alt: "Image: greeting",
                        text: "Yoda best Valentine!"
                    },
                    theme_images: {
                        "Puppies & Kittens": {
                            collection: "./img/dog-cat-valentine.jpg",
                            stickers:   "./img/puppy-valentine-clipart-8.jpg"
                        },
                        "Mickey & Minnie": {
                            collection: "./img/mickey_minnie_heart_500-428.gif",
                            stickers: "./img/mickey_minnie_stickers_192x189.png"
                        },
                        "Paw Patrol": {
                            collection: "./img/paw-patrol_400x521.png",
                            stickers: "./img/paw-patrol-stickers_192x240.png"
                        },                        
                        "Disney Cars": {
                            collection: "./img/cars-disney_400-180.png",
                            stickers:   "./img/cars-stickers_256-192.jpg"
                        },         
                        "JoJo Siwa": {
                            collection: "./img/jojo-siwa-260-260.jpeg",
                            stickers: "./img/jojo-siwa-stickers_192x190.jpg"
                        },  
                        "Avatar": {
                            collection: "./img/avatar-image_400x225.jpg",
                            stickers: "./img/avatar-stickers_192x148.png"
                        },     
                        "Batman": {
                            collection: "./img/batman_400x250.jpg",
                            stickers: "./img/batman_stickers_192x121.png"
                        },     
                        "Superman": {
                            collection: "./img/superman_400x407.png",
                            stickers: "./img/superman_stickers_192x166.jpeg"
                        },       
                        "Iron Man": {
                            collection: "./img/iron-man_400x480.png",
                            stickers: "./img/iron-man-stickers_192x222.png"
                        },                                                                                            
                        "Star Wars": {
                            collection: "./img/yoda-feature.jpg",
                            stickers:   "./img/stickers-for-kids-star-wars_224x192.png"
                        }
                    },
                    "products": [
                        {
                            sku: "1000",
                            title: "Happy Valentine's!",
                            price: 15,
                            in_stock: true,
                            card_themes: ["Puppies & Kittens", "Mickey & Minnie", "Paw Patrol"],
                            selection_values: 
                            {
                                quantity: "1",
                                theme: "Puppies & Kittens",
                                box: "3x6\" Basic Box"
                            },                            
                            set_items: [
                                {
                                    image: "./img/empty-red-box_247x163.jpg",
                                    description: ["3x6\" Basic Box"],
                                    item_type: "box"
                                },
                                {
                                    image: "./img/4_basic_markers_167x219.png",
                                    description: "4 Basic Markers",
                                    item_type: "markers"
                                },
                                {
                                    image: "./img/puppy-valentine-clipart-8.jpg",
                                    description: "2 Sticker Sheets",
                                    item_type: "stickers"
                                }
                            ]
                        },
                        {
                            sku: "2000",
                            title: "You Rock!",
                            price: 25,
                            in_stock: false,
                            card_themes: ["Disney Cars", "JoJo Siwa", "Puppies & Kittens",
                                          "Mickey & Minnie", "Paw Patrol"],                            
                            selection_values: 
                            {
                                quantity: "1",
                                theme: "Disney Cars",
                                box: "10x10\" Sturdy Box"
                            },
                            set_items: [
                                {
                                    image: "./img/sturdy_box.png",
                                    description: "10x10\" Sturdy Box",
                                    item_type: "box"
                                },
                                {
                                    image: "./img/10_deluxe_markers.jpeg",
                                    description: "10 Deluxe Markers",
                                    item_type: "markers"
                                },
                                {
                                    image: "./img/cars-stickers_256-192.jpg",
                                    description: "4 Sticker Sheets",
                                    item_type: "stickers"
                                },
                                {
                                    image: "./img/6_cutouts_192-192.png",
                                    description: "6 Valentine Cutouts",
                                    item_type: "cutouts"
                                },
                                {
                                    image: "./img/4_paints-and-brush_192x155.png",
                                    description: "4 Paints",
                                    item_type: "paints"
                                }
                            ]
                        },
                        {
                            sku: "3000",
                            title: "Extra Special!",
                            price: 50,
                            in_stock: true,
                            card_themes: ["Avatar", "Batman", "Superman", "Iron Man", "Star Wars", "Disney Cars",
                                            "JoJo Siwa", "Puppies & Kittens", "Mickey & Minnie", "Paw Patrol"],                            
                            selection_values: 
                            {
                                quantity: "1",
                                theme: "Star Wars",
                                box: "10x10\" Sturdy Box"
                            },                            
                            set_items: [
                                {
                                    image: "./img/sturdy_box.png",
                                    description: ["10x10\" Sturdy Box", "12x12\" Sturdy Box"],
                                    item_type: "box"
                                },
                                {
                                    image: "./img/10_deluxe_markers.jpeg",
                                    description: "10 Deluxe Markers",
                                    item_type: "markers"
                                },
                                {
                                    image: "./img/stickers-for-kids-star-wars_224x192.png",
                                    description: "6 Sticker Sheets",
                                    item_type: "stickers"
                                },
                                {
                                    image: "./img/10_cutouts_192-129.png",
                                    description: "10 Valentine Cutouts",
                                    item_type: "cutouts"
                                },
                                {
                                    image: "./img/6_pants_and_brush_192x193.jpeg",
                                    description: "6 Paints",
                                    item_type: "paints"
                                },
                                {
                                    image: "./img/design_templates_229x192.jpg",
                                    description: "4 Design Templates",
                                    item_type: "templates"
                                }
                            ]
                        }
                    ]
                },
                cart: {
                    items: [],
                    subtotal_price: 0,
                    tax: 0,
                    shipping_cost: 0,
                    total_price: 0,
                    purchase_type: "subscription"
                }
            }
        })
    </script>
</body>
</html>


